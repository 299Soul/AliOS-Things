<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>物联网操作系统AliOS Things 3.3: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygenextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="topbanner"><a href="https://github.com/Tencent/rapidjson" title="RapidJSON GitHub"><i class="githublogo"></i></a></div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md___users_yaoqiuguo_server_alios_3_3_components_ble_netconfig__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>@ ble_netconfig ble_netconfig</p>
<h1><a class="anchor" id="autotoc_md138"></a>
组件概述</h1>
<p>AliOS Things 3.3提供ble_netconfig组件，用内置的BLE功能给WI-FI配网。</p>
<h2><a class="anchor" id="autotoc_md139"></a>
功能支持</h2>
<p>ble_netconfig组件主要支持如下功能：</p>
<ul>
<li>开启BLE配网功能</li>
<li>关闭BLE配网功能</li>
</ul>
<h2><a class="anchor" id="autotoc_md140"></a>
版权说明</h2>
<blockquote class="doxtable">
<p>Apache license v2.0 </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md141"></a>
目录结构</h2>
<div class="fragment"><div class="line">|-- ble_netconfig.c          #BLE配网核心代码</div>
<div class="line">|-- ble_netconfig.h          #BLE配网头文件</div>
<div class="line">|-- package.yaml             #makefile</div>
<div class="line">|-- README.md                #README文档</div>
<div class="line">|-- BLE_NetConfig.zip        #BLE配网的示例APK,适用于android6.0及以上机型</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md142"></a>
依赖组件</h2>
<ul>
<li>osal_aos</li>
<li>ble_host</li>
<li>netmgr</li>
</ul>
<h1><a class="anchor" id="autotoc_md143"></a>
常用配置</h1>
<p>无</p>
<h1><a class="anchor" id="autotoc_md144"></a>
API介绍</h1>
<h2><a class="anchor" id="autotoc_md145"></a>
API列表</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">BLE_NetCfg_init   </th><th class="markdownTableHeadLeft">BLE配网初始化    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">BLE_NetCfg_start   </td><td class="markdownTableBodyLeft">BLE配网功能开启    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">BLE_NetCfg_stop   </td><td class="markdownTableBodyLeft">BLE配网功能关闭   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md146"></a>
API详情</h2>
<h3><a class="anchor" id="autotoc_md147"></a>
BLE_NetCfg_init</h3>
<p>BLE配网功能初始化。 <b>函数原型</b></p>
<div class="fragment"><div class="line">BLE_NETCFG_STATE BLE_NetCfg_init(BLE_netCfg_callck callback)</div>
</div><!-- fragment --><p> <b>输入参数</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">args   </th><th class="markdownTableHeadLeft">description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">callback   </td><td class="markdownTableBodyLeft">回调函数   </td></tr>
</table>
<p><b>返回参数</b> <code>0：</code>成功， <code>其他值</code>：失败。</p>
<h3><a class="anchor" id="autotoc_md148"></a>
BLE_NetCfg_start</h3>
<p>打开BLE配网功能。</p>
<p><b>函数原型</b></p>
<div class="fragment"><div class="line">BLE_NETCFG_STATE BLE_NetCfg_start(void)</div>
</div><!-- fragment --><p> <b>输入参数</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">args   </th><th class="markdownTableHeadLeft">description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">无   </td><td class="markdownTableBodyLeft"></td></tr>
</table>
<p><b>返回参数</b> <code>0：</code>成功， <code>其他值</code>：失败。</p>
<h3><a class="anchor" id="autotoc_md149"></a>
BLE_NetCfg_stop</h3>
<p>关闭BLE配网功能。 <b>函数原型</b></p>
<div class="fragment"><div class="line">BLE_NETCFG_STATE BLE_NetCfg_stop(void)</div>
</div><!-- fragment --><p> <b>输入参数</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">args   </th><th class="markdownTableHeadLeft">description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">无   </td><td class="markdownTableBodyLeft"></td></tr>
</table>
<p><b>返回参数</b> <code>0：</code>成功， <code>其他值</code>：失败。</p>
<h1><a class="anchor" id="autotoc_md150"></a>
使用示例</h1>
<h2><a class="anchor" id="autotoc_md151"></a>
案例工具</h2>
<ul>
<li>串口工具</li>
<li>安卓BLE配网测试APK（BLE_NetConfig.apk）</li>
</ul>
<h2><a class="anchor" id="autotoc_md152"></a>
案例修改</h2>
<p>以helloworld的案例为例，修改solutions/helloworld_demo/package.yaml的depends，增加ble_netconfig，如下 </p><div class="fragment"><div class="line">depends:</div>
<div class="line">  - ble_netconfig: master</div>
</div><!-- fragment --><p> 修改solutions/helloworld_demo/helloworld_demo.c，如下： <b>头文件修改</b> </p><div class="fragment"><div class="line">#include &lt;ble_netconfig.h&gt;</div>
</div><!-- fragment --><p> <b>代码修改</b> </p><div class="fragment"><div class="line">int application_start(int argc, char *argv[])</div>
<div class="line">{</div>
<div class="line">    int count = 0;</div>
<div class="line">    int ret;</div>
<div class="line"> </div>
<div class="line">    printf(&quot;nano entry here!\r\n&quot;);</div>
<div class="line"> </div>
<div class="line">#if 1</div>
<div class="line">    /* bt stack init */</div>
<div class="line">    ret = BLE_NetCfg_init(NULL);</div>
<div class="line">    if (ret) {</div>
<div class="line">        printf(&quot;error: BLE Net Config initial!, ret = %x\r\n&quot;, ret);</div>
<div class="line">        return -1;</div>
<div class="line">    }</div>
<div class="line">#endif</div>
<div class="line"> </div>
<div class="line">    while(1) {</div>
<div class="line">        printf(&quot;hello world! count %d \r\n&quot;, count++);</div>
<div class="line">        aos_msleep(1000);</div>
<div class="line">    };</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md153"></a>
编译烧录</h2>
<p>在solutions/helloworld_demo中执行aos make，编译成功后烧录进haas100开发板。</p>
<h2><a class="anchor" id="autotoc_md154"></a>
运行观测</h2>
<p>打开串口工具，在串口工具中输入ble_netCfg，可看到ble_netCfg的cli命令集。 <img src="https://img.alicdn.com/imgextra/i4/O1CN01R0MwTj1cIJOanG8Sq_!!6000000003577-2-tps-832-98.png#align=left&amp;display=inline&amp;height=49&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=98&amp;originWidth=832&amp;size=25099&amp;status=done&amp;style=none&amp;width=416" alt="image.png" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md155"></a>
BLE配网示例</h2>
<p>在串口工具中输入ble_netCfg start，可以在串口日志中看到如下打印 </p><div class="fragment"><div class="line">[15:10:06.498]收←◆ble_netCfg start</div>
<div class="line">[ 141.509]&lt;E&gt;BLE_NETCFG BLE_NetCfg_start: state = 0</div>
<div class="line">[ 145.532]&lt;E&gt;BLE_NETCFG adv start!</div>
</div><!-- fragment --><p> 之后，在测试的安卓手机上执行如下操作。</p>
<ul>
<li>解压BLE_NetConfig.zip后，在android手机(版本6.0及以上)侧安装并打开BLE_NetConfig.apk。</li>
<li>手机靠近开发板5米内，手机端点击FINDDEVICE按钮，可以在下拉列表中找到“HaaS NetConfig”这台设备并选择这个设备。</li>
<li>在SSID和Password区域填写需要连接的路由器的SSID和密码。</li>
<li>点击SETTING按钮，等待显示“**设置SSID与密码成功”**的提示。</li>
</ul>
<p><img src="https://img.alicdn.com/imgextra/i2/O1CN01ea2Bma1VtgP4ELRs6_!!6000000002711-2-tps-664-858.png#align=left&amp;display=inline&amp;height=429&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=858&amp;originWidth=664&amp;size=104536&amp;status=done&amp;style=none&amp;width=332" alt="image.png" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md156"></a>
常见问题</h1>
<div class="fragment"><div class="line">Q：是否有IOS版的配网工具</div>
<div class="line">A：目前没有，后续推出跨平台的小程序用于配网。</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
  </ul>
</div>
</body>
</html>
